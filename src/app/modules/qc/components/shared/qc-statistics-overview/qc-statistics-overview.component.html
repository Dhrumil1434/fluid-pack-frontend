<!-- QC Statistics Overview Card -->
<div
  class="relative overflow-hidden rounded-2xl bg-white/80 backdrop-blur-sm shadow-lg border border-white/20"
>
  <!-- Card Header -->
  <div class="p-6 border-b border-gray-100">
    <div class="flex items-center space-x-3">
      <div
        class="w-10 h-10 bg-gradient-to-r from-indigo-500 to-purple-500 rounded-xl flex items-center justify-center shadow-lg"
      >
        <i class="pi pi-chart-line text-white text-lg"></i>
      </div>
      <div>
        <h3 class="text-xl font-bold text-gray-900">Statistics Overview</h3>
        <p class="text-sm text-gray-500">QC performance metrics and trends</p>
      </div>
    </div>
  </div>

  <!-- Statistics Content -->
  <div class="p-6" *ngIf="data; else noData">
    <!-- Key Metrics -->
    <div class="grid grid-cols-2 gap-4 mb-6">
      <div class="text-center p-4 bg-gray-50 rounded-xl">
        <div class="text-2xl font-bold text-gray-900">
          {{ data.totalMachines }}
        </div>
        <div class="text-sm text-gray-600">Total Machines</div>
      </div>
      <div class="text-center p-4 bg-gray-50 rounded-xl">
        <div
          class="text-2xl font-bold"
          [ngClass]="getHealthScoreClass(data.averageHealthScore)"
        >
          {{ data.averageHealthScore }}%
        </div>
        <div class="text-sm text-gray-600">Avg Health Score</div>
      </div>
    </div>

    <!-- Machine Status Distribution -->
    <div class="mb-6">
      <h4 class="text-sm font-semibold text-gray-900 mb-3">
        Machine Status Distribution
      </h4>
      <div class="space-y-3">
        <!-- Active Machines -->
        <div class="flex items-center justify-between">
          <div class="flex items-center space-x-2">
            <div class="w-3 h-3 bg-success rounded-full"></div>
            <span class="text-sm text-gray-600">Active</span>
          </div>
          <div class="flex items-center space-x-2">
            <span class="text-sm font-semibold text-gray-900">{{
              data.activeMachines
            }}</span>
            <span class="text-xs text-gray-500"
              >({{ getMachineStatusPercentage('active') }}%)</span
            >
          </div>
        </div>
        <div class="w-full bg-gray-200 rounded-full h-2">
          <div
            class="bg-success h-2 rounded-full transition-all duration-500"
            [style.width.%]="getMachineStatusPercentage('active')"
          ></div>
        </div>

        <!-- Maintenance Machines -->
        <div class="flex items-center justify-between">
          <div class="flex items-center space-x-2">
            <div class="w-3 h-3 bg-warning rounded-full"></div>
            <span class="text-sm text-gray-600">Maintenance</span>
          </div>
          <div class="flex items-center space-x-2">
            <span class="text-sm font-semibold text-gray-900">{{
              data.maintenanceMachines
            }}</span>
            <span class="text-xs text-gray-500"
              >({{ getMachineStatusPercentage('maintenance') }}%)</span
            >
          </div>
        </div>
        <div class="w-full bg-gray-200 rounded-full h-2">
          <div
            class="bg-warning h-2 rounded-full transition-all duration-500"
            [style.width.%]="getMachineStatusPercentage('maintenance')"
          ></div>
        </div>
      </div>
    </div>

    <!-- Monthly Trend -->
    <div class="mb-4">
      <div class="flex items-center justify-between mb-3">
        <h4 class="text-sm font-semibold text-gray-900">Monthly Trend</h4>
        <div class="flex items-center space-x-1" [ngClass]="getTrendClass()">
          <i [class]="getTrendIcon()" class="text-xs"></i>
          <span class="text-xs font-medium">{{ getTrendText() }}</span>
        </div>
      </div>

      <!-- Simple Bar Chart -->
      <div class="flex items-end space-x-1 h-16">
        <div
          *ngFor="let value of data.monthlyTrend; let i = index; trackBy: i"
          class="flex-1 bg-blue-500 rounded-t transition-all duration-500 hover:bg-blue-600"
          [style.height]="getTrendBarHeight(value)"
          [title]="'Month ' + (i + 1) + ': ' + value + '%'"
        ></div>
      </div>

      <!-- Chart Labels -->
      <div class="flex justify-between text-xs text-gray-500 mt-2">
        <span
          *ngFor="
            let label of ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul'];
            trackBy: i
          "
          >{{ label }}</span
        >
      </div>
    </div>

    <!-- Health Score Indicator -->
    <div class="flex items-center justify-between p-3 bg-gray-50 rounded-xl">
      <div class="flex items-center space-x-2">
        <i
          [class]="getHealthScoreIcon(data.averageHealthScore)"
          [ngClass]="getHealthScoreClass(data.averageHealthScore)"
          class="text-lg"
        ></i>
        <span class="text-sm font-medium text-gray-900">Overall Health</span>
      </div>
      <div class="text-right">
        <div
          class="text-lg font-bold"
          [ngClass]="getHealthScoreClass(data.averageHealthScore)"
        >
          {{ data.averageHealthScore }}%
        </div>
        <div class="text-xs text-gray-500">Average Score</div>
      </div>
    </div>
  </div>

  <!-- No Data State -->
  <ng-template #noData>
    <div class="p-6 text-center">
      <div
        class="w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4"
      >
        <i class="pi pi-chart-line text-2xl text-gray-400"></i>
      </div>
      <h4 class="text-lg font-semibold text-gray-900 mb-2">
        No Statistics Available
      </h4>
      <p class="text-gray-500">
        Statistics will appear here once data is collected
      </p>
    </div>
  </ng-template>
</div>
